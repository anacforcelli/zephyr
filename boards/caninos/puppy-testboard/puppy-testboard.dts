#include <caninos/puppy.dtsi>
#include <mem.h>
#include <zephyr/dt-bindings/gpio/gpio.h>

/ {
    model = "puppy-testboard-v1";
    compatible = "caninos,puppy-testboard";

    chosen {
        zephyr,flash = &code_partition;
        zephyr,sram = &dtim;
        zephyr,console = &uart0;
        zephyr,shell-uart = &uart0;
    };

    aliases {
        led0 = &led0;
    };

    leds {
        compatible = "gpio-leds";
        led0: led_0 {
            gpios = <&gpio0 20 GPIO_ACTIVE_HIGH>;
            label = "LED0";
        };
    };
};

/* Reference existing nodes without redefining them */
&intc {
    status = "okay";
};

&gpio0 {
    status = "okay";
};

&uart0 {
    status = "okay";
    current-speed = <1250000>;
    parity = "none";
};

&spi0 {
    status = "okay";
    
    flash0: flash@0 {
        compatible = "jedec,spi-nor";
        reg = <0>;
        jedec-id = [00 20 18];
        spi-max-frequency = <1000000>;
        size = <DT_SIZE_M(16)>;
        status = "okay";
        
        partitions {
			/*
            compatible = "fixed-partitions";
            code_partition: partition@0 {
                reg = <0 0xF0000>;
                label = "code";
            };
            storage_partition: partition@F0000{
                reg = <0xF0000 0xF0000>;
                label = "storage";
            };
			user_sketch: partition@1E0000 {
				reg = <0x1E0000 0xF0000>;
			};*/
            compatible = "fixed-partitions";
            #address-cells = <1>;
            #size-cells = <1>;
            
            code_partition: partition@0 {
                reg = <0 0xF0000>;
                label = "code-partition";
            };
            user_sketch: partition@100000 {
                reg = <0x100000 0xF00000>;
                label = "storage";
            };
        };
    };
};

&i2c0 {
    status = "okay";
    clock-frequency = <100000>;
};

&i2c1 {
    status = "okay";
    clock-frequency = <100000>;
    sda-pin = <24>;
    scl-pin = <25>;
};
